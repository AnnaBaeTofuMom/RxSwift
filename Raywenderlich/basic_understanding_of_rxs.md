# Raywenderlich Chapter 1

## 1. 안녕, RxSwift!
> ### RxSwift란? <br> 
>비동기적이고 이벤트 베이스의 코드를 
옵저버블의 순서와 함수형의 오퍼레이터를 사용해 스케줄러가 파라미터로 수행할 수 있도록 만들어 주는 라이브러리

굉장히 복잡하게 들린다. 여기서 정말 필수적인 부분만 남긴다면 아래와 같아요.

> ### RxSwift란? <br> 
>여러분의 코드가 새로운 데이터와 프로세스에 순차적이고, 독립된 방식을 사용하게 함으로서 비동기 프로그램을 개발하는 것을 한층 더 쉽게 만들어 주는 라이브러리 입니다. 

---

### 비동기 프로그래밍이 뭔가요?

아래와 같은 것을 할 때를 떠올려 보세요.
- 버튼이 눌리면 반응하기
- 텍스트 필드가 포커스를 잃을 때 키보드 내려주기
- 인터넷에서 큰 용량의 사진을 다운받기
- 디스크에 데이터 저장하기
- 음악 재생하기

위 상황들은 동시에 일어나고 있는 것 처럼 보일 순 있지만 키보드가 내려간다고 해서 재생되던 음악이 정지하지는 않죠. 그런것처럼 각각의 실행이 다른 실행을 방해하지 않는다는 뜻이 됩니다. iOS는 다양한 API를 제공해서 서로 다른 스레드에서 작업이 실행될 수 있도록 하고, 각기 다른 CPU의 코어에서 작업할 수 있는 기능을 제공하고 있어요. 

---

### Cocoa 와 UIKit 비동기 API들

애플은 항상 비동기 코드를 쓸 수 있는 다양한 API를 제공했어요. 아마 기존에 프로젝트를 하면서 사용해본 적이 있으실 거예요. 

`NotificationCenter` : 관찰하고 있던 이벤트가 생기면 코드를 실행시켜주기 위해 사용하셨었죠?

`Delegate Pattern` : 특정 객체의 행동을 대리해서 정의할 수 있게 해주는 패턴

`Grand Central Dispatch` : 멀티 쓰레드 관리를 추상적으로 할 수 있게 도와주는 GCD. 코드를 순차적, 동시적 또는 지연을 주면서 실행할 수 있다. 

`Closure` : 코드의 일부를 떼어내서 다른 코드에 전달할 수 있도록 만들어 주는 클로저

`Combine` : Apple이 직접 만든 반응형 비동기 코드를 쓰기 위해 내놓은 프레임워크

---

<b>동기적인 코드</b>

동기적 코드의 예시예요. For문 돌면서 하나하나 무언가 해주는거 이전에도 많이 해보셨을텐데요. 두가지 특징이 있습니다. 

1. 순차적으로 실행이 된다.
2. 배열을 도는 동안 수정이 불가하다.

```Swift
var array = [1, 2, 3]
for number in array {
  print(number)
  array = [4, 5, 6]
}
print(array)
```

위 코드를 한번 실행시켜 보세요. for 문 내부에서 array를 변경하는게 가능하던가요? 중간에 number를 바꾸는건요?

<b>비동기적인 코드</b>

아래 코드는 비슷하긴 하지만, 이번에는 어떤 버튼을 탭할 때 마다 실행된다고 생각해보세요. 탭을 할 때 마다 다음 인덱스로 넘어가죠. 

```Swift
var array = [1, 2, 3]
var currentIndex = 0

// This method is connected in Interface Builder to a button
@IBAction private func printNext() {
  print(array[currentIndex])

  if currentIndex != array.count - 1 {
    currentIndex += 1
  }
}
```

동기 코드에서는 할 수 없었던 중간에 배열에 새 원소를 넣는다던지 하는 것이 가능해지네요. 

이 코드에서는 printNext()만 currentIndex를 수정할 수 있지만, 다른 코드도 currentIndex를 수정할 수 있죠. 

이제쯤 비동기 코드가 어떨 때 문제를 일으킬지 감이 오시죠?

>1) 일이 수행되는 순서가 보장되지 못함
>2) 중간에 공유 데이터가 변형될 수 있음

이런 문제들을 RxSwift가 잘 해결해 줄 수 있어요. 

## 비동기 프로그래밍 용어집

### 1. State(shared mutable state)
State라는 것은 뭐라 정의하기 어려운데요. 

노트북 샀는데 몇 주 쓰고 나니까 먹통이 되는 경험 해보셨나요? 하드웨어, 소프트웨어는 바뀐게 없는데 바로 State만 바뀐거랍니다. 그럴때 재시작 해주면 또 잘 돌아가잖아요?

여러분이 몇 주간 쓰면서 실행시키고, 저장하고, 데이터를 업로드 하고 다운로드 한 모든 결과의 총합이 현재의 State가 되는거예요. 

앱의 State를 여러개의 비동기 요소들을 공유하고 있을 때 잘 관리하는 방법을 배우게 될 것입니다. 

### 2. 명령형 프로그래밍
명령형 프로그래밍이라는건 프로그램의 State를 바꿔주기 위해서 구문을 그때 그때 써주는 프로그래밍이죠. 개랑 놀아주듯이 "Fetch해! 엎드려! 죽은척!" 하면서요. 

### 3. Side effects

Side effect는 현재 코드의 스코프 외부에 어떤 변화를 일으키는 걸 말해요. 간질환 약을 먹었는데 머리털이 나면 이것이 Side effect 이듯이 ㅎㅎ...

Side effect는 이름만 들으면 뭔가 안좋은 것 처럼 느껴지지만 실제로는 그런게 아니예요. 사실 모든 프로그래밍의 궁극적인 목표가 바로 이 Side effect 가 일어나게 하는 거라고 봐도 무방해요. 

뭔가가 일어나면, 결과적으로 무언가가 바뀌어야 앱이 재미있는거죠. 다만 중요한 건 이런 변화를 컨트롤 할 수 있어야 한다는 점이예요. 

### 4. 선언형 코드

명령형 프로그래밍에서는 여러분이 바꾸고 싶은 State를 바꾸죠. 함수형 프로그래밍에서는 코드의 Side effect를 최소화 하려고 하고요. 모든게 말처럼 다 완벽하면 좋겠지만, 이 중간의 어디쯤에 균형이 있겠죠. RxSwift는 선언형 코드의 좋은 점, 함수형 코드의 좋은 점을 잘 합쳐놓은 거예요. 

선언형 코드는 행동(behavior)의 조각들을 미리 선언을 해둬요. RxSwift가 특정 이벤트가 있을때마다 이 행동들을 실행해주고, 이 때 사용할 수 있는 수정 불가능하고 독립적인 데이터를 제공해요. 

이렇게 하면 비동기 코드를 활용하면서도, 위에서 말한 `for`문에서 있었던 데이터를 수정할 수 없는 문제를 해결할 수 있죠. 그러면서도 순차적으로, 계획적으로 코드를 실행할 수 있고요! 

### 5. 반응형 시스템
반응형 시스템이란 꽤 추상적인 용어이고, 아래의 항목에 다 부합하는 앱이나 웹을 말해요. 

- 반응형: UI가 항상 최신정보로 업데이트가 되어있다.
- Resilient: 각각의 행동이 독립적으로 정의되어 있고, 에러 복구에 유연하게 대응할 수 있음.
- Elastic: 코드가 다양한 워크로드를 컨트롤 할 수 있고, 지연 풀 기반 데이터 수집, 이벤트 제한 및 리소스 공유와 같은 기능을 구현.
- 메시지 기반: 사용성과 독립성을 보장하기 위해 각각의 요소들이 메시지를 기반으로 한 교류를 해서 클래스의 적용과 lifecycle을 분리.


